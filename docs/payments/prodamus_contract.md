# Prodamus контракт в проекте (MVP)

## Принцип интеграции

Используется упрощённый и фактический для текущего продукта поток:
1. Генерация ссылки на оплату через `PRODAMUS_FORM_URL`.
2. Оплата пользователем на форме.
3. Подтверждение оплаты webhook-уведомлением на `POST /webhooks/payments`.

Никакой отдельный status API в продуктовой логике не используется.

## Обязательные параметры

- `PRODAMUS_FORM_URL`
- `PRODAMUS_KEY` (единый ключ)
- `PAYMENT_WEBHOOK_URL`

## Проверка webhook

`verify_webhook` принимает webhook только при валидной подписи/секрете по текущей реализации в `app/payments/prodamus.py`.
После успешной проверки:
- извлекается `order_id`;
- по `status` определяется признак оплаты;
- в `orders` статус меняется на `PAID`.

## Важно

Если webhook не приходит или не проходит подпись, заказ останется в `CREATED`/`PENDING`.
Поэтому основной операционный контроль — корректная настройка `PAYMENT_WEBHOOK_URL` в Prodamus.
